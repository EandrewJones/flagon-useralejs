/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * @preserved
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).userale={})}(this,function(t){"use strict";var e="2.1.1";let r=null;function n(t,o){Object.keys(o).forEach(function(e){var n;"userFromParams"!==e||(n=function(e){const n=e,t=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),o=window.location.href.match(t);return o&&o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):null}(o[e]))&&(t.userId=n),t[e]=o[e]})}var o,i,a,s=function(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;for(var o=Array(e),i=0,n=0;n<t;n++)for(var r=arguments[n],a=0,s=r.length;a<s;a++,i++)o[i]=r[a];return o},l=function(e,n,t){this.name=e,this.version=n,this.os=t,this.type="browser"},u=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},c=function(e,n,t,o){this.name=e,this.version=n,this.os=t,this.bot=o,this.type="bot-device"},d=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},f=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},m=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,p=3,h=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],w=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function g(e){var o,n=""!==(o=e)&&h.reduce(function(e,n){var t=n[0],n=n[1];if(e)return e;n=n.exec(o);return!!n&&[t,n]},!1);if(!n)return null;var t=n[0],i=n[1];if("searchbot"===t)return new d;n=i[1]&&i[1].split(/[._]/).slice(0,3);n?n.length<p&&(n=s(n,function(e){for(var n=[],t=0;t<e;t++)n.push("0");return n}(p-n.length))):n=[];i=n.join("."),n=function(e){for(var n=0,t=w.length;n<t;n++){var o=w[n],i=o[0];if(o[1].exec(e))return i}return null}(e),e=m.exec(e);return e&&e[1]?new c(t,i,n,e[1]):new l(t,i,n)}const v=o?g(o):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new f:"undefined"!=typeof navigator?g(navigator.userAgent):"undefined"!=typeof process&&process.version?new u(process.version.slice(1)):null;let y,b,S,O,T,W,k,N,I=null,E=null;function x(e,n){if(!b.on)return!1;let t=null;n&&(t=n(e));n=e.timeStamp&&0<e.timeStamp?b.time(e.timeStamp):Date.now(),n={milli:Math.floor(n),micro:Number((n%1).toFixed(3))};let o={target:A(e.target),path:C(e),pageUrl:window.location.href,pageTitle:document.title,pageReferrer:document.referrer,browser:K(),clientTime:n.milli,microTime:n.micro,location:null!=(n=e).pageX?{x:n.pageX,y:n.pageY}:null!=n.clientX?{x:document.documentElement.scrollLeft+n.clientX,y:document.documentElement.scrollTop+n.clientY}:{x:null,y:null},scrnRes:B(),type:e.type,logType:"raw",userAction:!0,details:t,userId:b.userId,toolVersion:b.version,toolName:b.toolName,useraleVersion:b.useraleVersion,sessionID:b.sessionID};return!("function"==typeof I&&!I(o))&&("function"==typeof E&&(o=E(o,e)),y.push(o),!0)}function D(e,n,t){if(!b.on)return!1;let o=null;n&&(o=n());t={pageUrl:window.location.href,pageTitle:document.title,pageReferrer:document.referrer,browser:K(),clientTime:Date.now(),scrnRes:B(),logType:"custom",userAction:t,details:o,userId:b.userId,toolVersion:b.version,toolName:b.toolName,useraleVersion:b.useraleVersion,sessionID:b.sessionID};let i=Object.assign(t,e);return!("function"==typeof I&&!I(i))&&("function"==typeof E&&(i=E(i)),y.push(i),!0)}function B(){return{width:window.innerWidth,height:window.innerHeight}}function A(e){return e.localName?e.localName+(e.id?"#"+e.id:"")+(e.className?"."+e.className:""):e.nodeName?e.nodeName+(e.id?"#"+e.id:"")+(e.className?"."+e.className:""):e&&e.document&&e.location&&e.alert&&e.setInterval?"Window":"Unknown"}function C(n){let t=[];if(n.path)t=n.path;else{let e=n.target;for(;e;)t.push(e),e=e.parentElement}return function(e){let n=0,t;const o=[];for(;t=e[n];)o.push(A(t)),++n;return o}(t)}function K(){return{browser:v?v.name:"",version:v?v.version:""}}let M=null;function L(e,n){var t,o,i,r;null!==M&&clearInterval(M),M=(t=e,o=n,setInterval(function(){o.on&&t.length>=o.logCountThreshold&&(V(t.slice(0),o,0),t.splice(0))},o.transmitInterval)),i=e,(r=n).on&&(navigator.sendBeacon?window.addEventListener("unload",function(){navigator.sendBeacon(r.url,JSON.stringify(i))}):window.addEventListener("beforeunload",function(){0<i.length&&V(i,r,1)}))}function V(e,n,t){const o=new XMLHttpRequest;var i=JSON.stringify(e);o.open("POST",n.url),n.authHeader&&o.setRequestHeader("Authorization",n.authHeader),o.setRequestHeader("Content-type","application/json;charset=UTF-8"),o.onreadystatechange=function(){4===o.readyState&&200!==o.status&&0<t&&V(e,n,t--)},o.send(i)}let P,R,X;const _=["click","focus","blur","input","change","mouseover","submit"];let j;const $=["load","blur","focus"];function H(e){return{clicks:e.detail,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey}}function Y(o){var e;return e=o,P={click:H,dblclick:H,mousedown:H,mouseup:H,focus:null,blur:null,input:e.logDetails?function(e){return{value:e.target.value}}:null,change:e.logDetails?function(e){return{value:e.target.value}}:null,dragstart:null,dragend:null,drag:null,drop:null,keydown:e.logDetails?function(e){return{key:e.keyCode,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey}}:null,mouseover:null},R={},X={wheel:function(e){return{x:e.deltaX,y:e.deltaY,z:e.deltaZ}},scroll:function(){return{x:window.scrollX,y:window.scrollY}},resize:function(){return{width:window.outerWidth,height:window.outerHeight}}},j={submit:null},Object.keys(P).forEach(function(n){document.addEventListener(n,function(e){x(e,P[n])},!0)}),_.forEach(function(e){document.addEventListener(e,function(e){!function(e){var n=A(e.target),t=C(e),o=e.type,i=Math.floor(e.timeStamp&&0<e.timeStamp?b.time(e.timeStamp):Date.now());if(null==S&&(S=n,O=o,T=t,W=i,k=0),S!==n||O!==o){if(N={target:S,path:T,pageUrl:window.location.href,pageTitle:document.title,pageReferrer:document.referrer,browser:K(),count:k,duration:i-W,startTime:W,endTime:i,type:O,logType:"interval",targetChange:S!==n,typeChange:O!==o,userAction:!1,userId:b.userId,toolVersion:b.version,toolName:b.toolName,useraleVersion:b.useraleVersion,sessionID:b.sessionID},"function"==typeof I&&!I(N))return;"function"==typeof E&&(N=E(N,e)),y.push(N),S=n,O=o,T=t,W=i,k=0}S==n&&O==o&&(k+=1)}(e)},!0)}),Object.keys(X).forEach(function(n){R[n]=!0,window.addEventListener(n,function(e){R[n]&&(R[n]=!1,x(e,X[n]),setTimeout(function(){R[n]=!0},o.resolution))},!0)}),Object.keys(j).forEach(function(t){document.addEventListener(t,function(e){var n;x(e,P[t]),n=y,(e=o).on&&0<n.length&&V(n,e,1)},!0)}),$.forEach(function(e){window.addEventListener(e,function(e){x(e,function(){return{window:!0}})},!0)}),1}const F={},z=[],J=Date.now();let U;function q(n){t.started||setTimeout(function(){var e=document.readyState;"interactive"===e||"complete"===e?(Y(n),L(z,n),t.started=n.on=!0,D({type:"load",logType:"raw",pageLoadTime:U-J},()=>{},!1)):q(n)},100)}window.onload=function(){U=Date.now()},t.started=!1,F.on=!1,F.useraleVersion=e,n(F,function(){const e={};var n,t;null===r&&(r=(n="userAleSessionId",t="session_"+String(Date.now()),null!==window.sessionStorage.getItem(n)?JSON.parse(window.sessionStorage.getItem(n)):(window.sessionStorage.setItem(n,JSON.stringify(t)),t)));const o=document.currentScript||(t=document.getElementsByTagName("script"))[t.length-1],i=o?o.getAttribute.bind(o):function(){return null};return e.autostart="false"!==i("data-autostart"),e.url=i("data-url")||"http://localhost:8000",e.transmitInterval=+i("data-interval")||5e3,e.logCountThreshold=+i("data-threshold")||5,e.userId=i("data-user")||null,e.version=i("data-version")||null,e.logDetails="true"===i("data-log-details"),e.resolution=+i("data-resolution")||500,e.toolName=i("data-tool")||null,e.userFromParams=i("data-user-from-params")||null,e.time=function(e){let n;if(e.timeStamp&&0<e.timeStamp){var t=Date.now()-e.timeStamp;if(t<0)n=function(){return e.timeStamp/1e3};else if(t>e.timeStamp){const o=performance.timing.navigationStart;n=function(e){return e+o}}else n=function(e){return e}}else n=function(){return Date.now()};return n}(document.createEvent("CustomEvent")),e.sessionID=i("data-session")||r,e.authHeader=i("data-auth")||null,e.custIndex=i("data-index")||null,e}()),i=z,a=F,y=i,b=a,I=null,E=null,S=null,O=null,T=null,W=null,k=0,N=null,F.autostart&&q(F);t.buildPath=C,t.details=function(e,n){return{click:H,dblclick:H,mousedown:H,mouseup:H,focus:null,blur:null,input:e.logDetails?function(e){return{value:e.target.value}}:null,change:e.logDetails?function(e){return{value:e.target.value}}:null,dragstart:null,dragend:null,drag:null,drop:null,keydown:e.logDetails?function(e){return{key:e.keyCode,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey}}:null,mouseover:null,wheel:function(e){return{x:e.deltaX,y:e.deltaY,z:e.deltaZ}},scroll:function(){return{x:window.scrollX,y:window.scrollY}},resize:function(){return{width:window.outerWidth,height:window.outerHeight}},submit:null}[n]},t.filter=function(e){I=e},t.getSelector=A,t.log=function(e){return null!==e&&"object"==typeof e&&(z.push(e),!0)},t.map=function(e){E=e},t.options=function(e){return void 0!==e&&n(F,e),F},t.packageCustomLog=D,t.packageLog=x,t.start=function(){t.started||q(F),F.on=!0},t.stop=function(){F.on=!1},t.version="2.1.1",Object.defineProperty(t,"__esModule",{value:!0})});